if arg[2] == "debug" then
    require("lldebugger").start()
end

SCREEN_WIDTH = 800
SCREEN_HEIGHT = 600

local SCREEN_INDEX = 1

Screens = {}

function ChangeScreen(index)

    if index > #Screens then
        print("invalid index")
        return
    end

    SCREEN_INDEX = index

    Screens[SCREEN_INDEX]:Reset()

end

function love.load()
    local StartScreen = require "startScreen"
    local LevelSelect = require "LevelSelect"
    local Level = require "level"
    local WinScreen = require "win"
    local tutorial = require "tutorial"
    Song = love.audio.newSource("Audio/music.ogg", "stream")
    Song:setLooping(true)
    Song:play()

    SelectSfx = love.audio.newSource("Audio/click.ogg", "static")
    Step = love.audio.newSource("Audio/step.ogg", "static")
    MenuNav = love.audio.newSource("Audio/MenuNav.ogg", "static")
    Unlock = love.audio.newSource("Audio/Unlock.ogg", "static")
    RedTileTouch = love.audio.newSource("Audio/Wilhelm.ogg", "static")
    WinSFX = love.audio.newSource("Audio/WinScreen.ogg", "static")


    --create screens here
    table.insert(Screens, StartScreen())
    table.insert(Screens, LevelSelect())
    table.insert(Screens, WinScreen())
    table.insert(Screens, tutorial())
    table.insert(Screens, Level(
        {
            4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
            4,1,0,0,7,0,0,0,4,0,0,0,0,2,4,
            4,4,4,0,4,0,4,0,4,0,4,4,4,0,4,
            4,0,0,0,0,0,4,0,0,0,0,0,4,0,4,
            4,0,4,4,4,4,4,4,4,4,4,0,4,0,4,
            4,0,4,0,0,0,0,0,0,0,4,0,4,0,4,
            4,0,4,0,4,4,4,4,4,0,4,0,4,0,4,
            4,0,0,0,4,0,0,0,4,0,4,0,4,0,4,
            4,4,4,0,4,0,4,0,4,0,4,0,4,0,4,
            4,0,0,0,0,0,4,0,0,0,0,0,4,0,4,
            4,0,4,4,4,4,4,4,4,4,4,0,4,0,4,
            4,0,4,0,0,0,0,0,0,0,4,0,4,0,4,
            4,0,4,0,4,4,4,4,4,0,4,0,4,0,4,
            4,0,0,0,4,0,0,0,4,0,0,8,0,3,4,
            4,4,4,4,4,4,4,4,4,4,4,4,4,4,4
        }
        , 
    15))
    table.insert(Screens, Level(
    {

         4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
         4,1,0,0,0,5,5,5,5,0,0,0,0,0,4,
         4,4,0,4,0,4,4,4,4,0,4,4,4,0,4,
         4,0,0,4,0,0,0,2,0,0,4,0,0,0,4,
         4,0,4,4,4,4,4,4,0,4,4,0,4,4,4,
         4,0,0,0,0,0,0,7,0,0,0,0,0,0,4,
         4,4,5,4,4,4,0,4,4,4,4,4,4,0,4,
         4,0,0,0,0,0,0,0,0,0,0,0,4,0,4,
         4,0,4,4,4,4,5,4,4,4,4,0,4,0,4,
         4,0,4,0,0,0,0,0,0,0,4,0,4,0,4,
         4,0,4,0,4,4,4,4,4,0,4,0,4,0,4,
         4,0,4,0,4,0,0,0,4,0,4,0,4,0,4,
         4,0,0,8,4,0,5,0,5,0,5,0,8,0,4,
         4,4,4,3,0,0,4,0,0,0,4,4,9,4,4,
         4,4,4,4,4,4,4,4,4,4,4,4,4,4,4
    }, 
    15)) 
    table.insert(Screens, Level(
    {
        4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
        4,2,0,0,0,5,5,5,5,0,4,0,0,1,4,
        4,4,4,0,4,4,4,4,0,0,4,0,4,0,4,
        4,0,0,0,4,0,0,4,0,4,4,0,4,0,4,
        4,0,4,4,4,0,4,4,0,4,0,0,4,0,4,
        4,0,0,0,0,0,0,4,0,4,0,4,4,0,4,
        4,7,4,0,4,4,0,4,0,0,0,0,0,0,4,
        4,0,0,0,8,4,0,4,4,4,4,4,4,0,4,
        4,0,4,0,8,4,0,0,0,0,0,0,4,0,4,
        4,0,4,0,8,4,4,4,4,4,4,0,4,0,4,
        4,0,4,0,4,4,0,0,0,0,4,0,4,0,4,
        4,0,4,0,4,0,0,4,4,0,4,0,4,0,4,
        4,0,5,0,5,0,4,4,4,8,0,0,0,0,4,
        4,3,4,8,4,0,0,9,4,4,4,4,4,0,4,
        4,4,4,4,4,4,4,4,4,4,4,4,4,4,4
    }, 
    15)) 
    table.insert(Screens, Level(
    {
        4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
        4,1,0,0,0,0,0,0,0,0,4,0,5,5,5,5,5,2,0,4,
        4,4,4,4,4,4,0,4,4,0,4,0,4,4,4,4,5,4,0,4,
        4,8,0,0,0,4,0,4,0,0,0,0,0,0,0,4,5,4,0,4,
        4,0,4,4,0,0,0,4,4,4,4,4,4,4,0,4,5,4,0,4,
        4,0,4,0,0,4,0,0,0,0,0,0,0,4,0,4,5,4,0,4,
        4,0,4,0,4,4,4,4,4,4,4,4,0,4,0,4,5,4,0,4,
        4,0,4,0,4,0,0,0,0,0,0,4,0,4,0,4,5,4,0,4,
        4,0,4,0,4,0,4,4,4,4,0,4,8,4,0,4,5,4,0,4,
        4,0,0,0,0,0,4,0,0,4,0,4,0,0,0,0,0,0,0,4,
        4,4,4,4,4,0,4,0,4,4,0,4,4,4,4,4,4,4,0,4,
        4,0,8,0,4,0,4,0,0,0,0,0,0,0,0,0,0,4,0,4,
        4,0,4,0,4,0,4,4,4,4,4,4,4,4,4,4,0,4,0,4,
        4,0,4,0,4,0,5,5,5,5,5,5,5,5,5,0,0,4,0,4,
        4,0,4,0,4,0,4,4,4,4,4,4,4,9,4,4,4,4,0,4,
        4,0,4,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,4,
        4,3,4,4,4,4,4,4,4,4,8,0,4,5,4,4,4,4,0,4,
        4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,4,
        4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
        4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
    }, 
    20)) 
    table.insert(Screens, Level(
    {
        4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
        4,1,0,0,4,0,0,0,4,0,0,0,0,4,0,5,5,5,3,4,
        4,4,4,0,4,0,4,0,4,0,4,4,0,4,0,4,4,5,8,4,
        4,0,0,0,0,0,4,0,0,0,4,0,0,0,0,0,4,5,0,4,
        4,0,4,4,4,4,4,4,4,0,4,4,4,4,4,0,4,4,0,4,
        4,0,4,0,0,0,0,0,4,0,0,0,0,0,4,0,0,4,0,4,
        4,0,4,0,4,4,4,0,4,4,4,4,4,0,4,4,0,4,0,4,
        4,0,4,0,4,0,4,0,0,0,0,0,4,0,0,4,0,4,0,4,
        4,0,4,0,4,0,4,4,4,4,4,0,4,4,0,4,0,4,0,4,
        4,0,0,0,5,0,0,8,0,2,4,0,0,4,0,0,0,4,0,4,
        4,4,4,0,4,4,4,4,0,4,4,4,0,4,4,4,0,4,0,4,
        4,0,0,0,4,0,0,4,0,0,0,4,0,0,0,4,0,4,0,4,
        4,0,4,4,4,0,4,4,5,4,0,4,4,4,0,4,0,4,0,4,
        4,0,4,0,0,0,0,0,0,4,0,0,0,0,0,4,0,0,0,4,
        4,0,4,0,4,4,4,4,0,4,4,4,4,4,0,4,4,4,0,4,
        4,0,0,0,4,0,0,4,0,0,0,0,0,4,0,0,0,4,0,4,
        4,4,4,0,4,0,4,4,4,4,4,4,0,4,4,4,0,4,0,4,
        4,0,0,0,4,0,0,0,0,0,0,4,0,0,0,4,0,4,0,4,
        4,0,4,4,4,4,4,4,4,4,9,4,4,4,0,5,5,5,0,4,
        4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4
    }, 
    20)) 
    table.insert(Screens, Level(
        {
            4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
            4,1,0,0,5,5,5,5,0,0,0,4,0,8,0,0,0,0,3,4,
            4,5,4,0,4,4,0,4,0,4,0,4,0,4,7,5,4,0,4,4,
            4,5,0,0,0,4,0,4,0,4,0,4,0,5,5,5,7,0,8,4,
            4,5,4,4,0,4,0,4,0,4,8,4,0,4,4,4,4,0,0,4,
            4,5,5,4,0,4,0,4,0,4,0,4,0,0,0,0,0,4,0,4,
            4,5,0,4,0,4,0,4,0,4,0,4,4,4,4,4,0,4,0,4,
            4,0,0,4,0,4,0,4,0,4,0,0,5,5,5,5,0,4,0,4,
            4,0,4,4,0,4,0,4,0,4,4,4,4,4,5,4,0,4,0,4,
            4,0,5,5,0,0,0,0,0,0,0,0,0,4,5,4,0,0,0,4,
            4,0,4,4,4,4,4,4,4,4,4,4,0,4,5,4,4,4,0,4,
            4,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,4,0,4,
            4,5,4,4,4,4,4,4,4,4,0,4,4,4,4,4,0,4,0,4,
            4,5,5,5,5,5,5,5,5,5,0,5,5,5,5,4,0,0,0,4,
            4,5,4,5,4,4,0,4,4,4,0,4,4,4,5,4,4,4,0,4,
            4,0,0,0,0,4,0,4,0,0,0,5,0,0,0,0,0,0,0,4,
            4,5,4,4,0,4,0,4,0,4,4,4,4,4,4,4,4,4,0,4,
            4,0,0,0,0,5,0,0,0,5,5,5,5,5,5,5,5,0,0,4,
            4,9,4,4,4,4,4,4,0,4,4,4,4,4,4,4,4,4,2,4,
            4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4
        }, 
    20)) 
     table.insert(Screens, Level(
     {
        4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
        4,1,0,0,0,0,4,4,4,4,0,0,0,0,0,0,0,0,3,4,
        4,5,4,4,4,0,4,0,0,0,0,4,5,5,5,5,5,5,8,4,
        4,5,5,5,4,0,4,0,4,4,0,4,7,4,0,4,0,4,0,4,
        4,4,4,5,4,0,5,0,0,4,0,4,5,4,0,4,0,0,0,4,
        4,0,0,0,0,0,4,0,4,4,0,4,0,0,0,4,4,4,0,4,
        4,0,4,0,4,0,4,0,0,0,0,4,0,4,0,0,5,4,0,4,
        4,0,4,0,4,0,4,4,4,4,0,4,0,4,4,4,5,4,0,4,
        4,0,0,0,0,0,0,0,0,4,0,4,0,4,5,0,0,4,0,4,
        4,4,4,0,4,4,4,4,0,4,0,4,0,4,4,4,4,4,0,4,
        4,7,5,0,5,5,5,4,0,4,0,4,0,0,0,0,0,0,0,4,
        4,0,4,0,4,4,7,4,0,4,0,4,4,4,4,4,4,4,0,4,
        4,0,4,0,0,5,0,4,0,4,0,0,0,0,0,0,0,4,0,4,
        4,0,4,8,4,4,0,4,0,4,4,4,4,4,4,4,0,4,0,4,
        4,0,4,0,4,4,0,4,0,0,0,0,0,0,0,0,0,4,0,4,
        4,0,0,0,4,4,0,4,5,4,4,4,4,4,0,4,0,4,0,4,
        4,4,4,0,0,0,0,0,0,0,4,7,0,0,0,4,0,0,0,4,
        4,2,4,5,4,4,4,4,0,4,4,4,4,4,0,4,4,4,4,4,
        4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,4,
        4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4
     }, 
    20)) 
     table.insert(Screens, Level(
     {

         4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
         4,4,0,0,4,5,7,0,0,3,4,4,4,0,0,0,0,0,0,4,
         4,4,4,0,4,5,4,0,4,0,4,7,4,0,4,4,4,4,0,4,
         4,7,5,0,5,5,5,0,4,0,4,5,4,0,4,5,5,4,0,4,
         4,0,4,0,4,5,4,0,4,0,4,5,4,8,4,4,5,4,0,4,
         4,0,4,0,0,0,0,0,4,0,0,0,0,0,4,0,0,4,0,4,
         4,0,4,4,4,4,4,4,4,4,4,4,4,0,4,4,8,4,0,4,
         4,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,4,0,4,
         4,0,4,4,4,4,4,4,4,4,4,0,4,4,4,4,0,4,0,4,
         4,0,5,5,5,5,5,5,5,5,4,0,0,0,0,4,0,4,0,4,
         4,0,4,4,4,4,4,4,4,5,4,4,4,4,0,4,0,4,0,4,
         4,0,4,0,0,0,0,0,4,5,1,0,0,4,0,4,0,4,0,4,
         4,0,4,0,4,4,4,0,4,5,4,4,0,5,0,4,0,4,0,4,
         4,0,4,0,4,7,4,0,0,5,5,4,0,4,0,4,0,4,0,4,
         4,0,4,0,4,5,4,4,4,4,5,4,0,4,0,4,0,4,0,4,
         4,0,4,0,4,5,5,5,5,4,5,4,0,4,0,0,0,4,0,4,
         4,0,4,0,4,4,4,4,5,4,5,4,0,4,4,4,0,4,0,4,
         4,2,0,0,0,0,0,0,0,0,5,4,0,0,0,4,0,4,0,4,
         4,4,4,4,4,4,4,4,4,4,7,4,4,4,0,0,0,0,9,4,
         4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4

                }, 
    20)) 
    table.insert(Screens, Level(
     {
        4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
        4,9,0,0,0,4,4,0,0,1,0,4,4,4,4,4,4,4,0,4,
        4,4,4,4,0,4,5,5,5,5,0,4,5,5,5,5,5,4,0,4,
        4,5,5,5,0,5,5,4,4,5,0,4,5,4,4,4,5,4,0,4,
        4,5,4,4,0,4,5,4,0,5,0,4,5,4,0,0,5,4,0,4,
        4,5,0,0,0,0,5,4,4,4,0,4,5,4,0,4,4,4,0,4,
        4,5,4,5,4,4,5,5,5,4,0,4,5,0,0,0,0,0,0,4,
        4,5,4,5,5,4,4,4,5,4,0,4,4,4,4,4,4,4,0,4,
        4,5,4,4,5,5,5,4,5,4,0,0,0,0,0,0,4,4,0,4,
        4,5,4,4,4,4,5,4,5,4,4,4,4,4,0,4,4,4,0,4,
        4,0,0,0,0,4,5,4,0,0,0,0,0,4,0,4,0,0,0,4,
        4,4,4,4,0,4,5,4,4,4,4,4,0,4,0,4,0,4,4,4,
        4,0,0,4,0,4,5,5,5,5,5,4,0,4,0,4,0,4,0,4,
        4,0,4,4,0,4,4,4,4,4,5,4,0,4,0,4,0,4,0,4,
        4,0,4,0,0,0,0,0,0,4,5,4,0,4,0,0,0,4,0,4,
        4,0,4,4,4,4,4,4,0,4,5,4,0,4,4,4,0,4,0,4,
        4,0,0,0,0,0,0,4,0,4,5,4,0,0,0,4,0,4,0,4,
        4,7,4,4,4,4,0,4,0,4,5,4,4,4,0,4,0,4,0,4,
        4,3,8,0,0,0,0,0,0,0,5,0,0,0,0,4,0,0,2,4,
        4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4
     }, 
     20))
     table.insert(Screens, Level(
     {
         4,4,4,4,4,4,4,4,4,5,4,4,4,4,4,4,4,4,4,4,
         4,5,5,5,5,5,5,5,5,5,5,5,4,4,4,5,5,5,5,4,
         4,5,5,5,4,4,4,5,4,4,4,5,4,4,5,5,4,4,5,4,
         4,7,4,5,4,4,4,5,5,5,4,5,5,5,6,4,7,5,5,4,
         4,5,4,5,4,4,4,4,4,5,4,5,4,4,7,5,4,5,4,4,
         4,7,5,5,5,5,5,5,4,5,5,5,4,4,4,5,4,5,4,4,
         4,4,4,5,4,4,4,5,5,4,4,4,4,5,5,5,4,5,4,4,
         4,4,4,5,5,5,4,4,5,5,5,5,4,5,4,4,4,5,4,4,
         4,4,4,4,4,5,4,4,4,4,4,5,4,5,4,5,5,5,4,4,
         4,4,4,4,4,5,5,5,5,5,5,5,4,5,5,5,4,5,5,4,
         4,4,4,4,4,4,4,4,4,4,4,5,4,4,4,7,4,4,5,4,
         4,7,4,4,4,4,5,5,5,5,5,5,5,5,5,4,4,4,5,4,
         4,5,4,4,4,4,5,4,4,4,4,4,4,4,5,4,4,4,5,4,
         4,5,5,5,5,5,5,4,4,4,4,4,4,4,5,5,5,4,5,4,
         4,4,4,4,4,4,5,4,4,4,4,4,4,4,4,4,5,5,5,4,
         4,4,4,4,4,4,5,5,5,5,5,4,4,4,4,4,5,4,4,4,
         4,4,4,4,4,4,4,4,4,4,5,4,4,4,4,4,5,4,4,4,
         4,4,4,4,4,4,4,4,4,4,5,5,7,4,4,4,5,5,7,4,
         4,4,4,4,4,4,4,4,4,2,1,4,4,4,4,4,4,4,4,4,
         4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4
     }, 
     20))

    

end

function love.update(dt)
    Screens[SCREEN_INDEX]:Update(dt)

end

function love.draw() 
    Screens[SCREEN_INDEX]:DrawScreen()
    
end    

function love.keypressed(key)
    Screens[SCREEN_INDEX]:Keypressed(key)
end

function love.mousepressed(x,y,key)
    Screens[SCREEN_INDEX]:mousepressed(x,y,key)
end


local love_errorhandler = love.errorhandler

function love.errorhandler(msg)
    if lldebugger then
        error(msg, 2)
    else
        return love_errorhandler(msg)
    end
end
